#!/bin/sh
# Read Linux manual pages from Debian
# See man(1) and mandoc(1) for options

usage() {
	cat << EOF &&
usage: ${0##*/} [-c] [-l language] [-s section] [-O options]
            [-O options] [-T output] name
EOF
	exit ${1}
}

args=$(getopt cl::s::O::T:: "${@}")
[ ${?} -eq 0 ] || usage 2

set -- ${args}

# host specific defaults
host=https://manpages.debian.org
suite=/unstable
fmt=.gz

# man(1)/mandoc(1) flags
[ -t 0 ] &&
	cflag=-a ||
	cflag=-c

while [ ${#} -ne 0 ]; do
	case "${1}"
	in
	-c)
		cflag=-c
		shift;;
	-l)
		lang=."${2}"
		shift 2;;
	-s)
		section=."${2}"
		shift 2;;
	-T)
		Tflag=-T"${2}"
		shift 2;;
	--)
		shift
		break;;
	esac
done

[ -z "${@}" ] && usage 5

name=/"${@}"
url="${host}${suite}${pkg}${name}${section}${lang}${fmt}"

curl -fLsS "${url}" |
	mandoc ${cflag} ${Oflag} ${Tflag}
